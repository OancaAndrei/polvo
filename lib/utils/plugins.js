// Generated by CoffeeScript 1.6.3
(function() {
  var app, app_manifest, dep, dirs, err, mods, path, polvo, polvo_manifest, util, _,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  _ = require('lodash');

  path = require('path');

  util = require('util');

  dirs = require('../utils/dirs');

  mods = [];

  polvo_manifest = path.join(dirs.root, 'package.json');

  if (fs.existsSync(polvo_manifest)) {
    polvo = require(polvo_manifest);
    for (dep in polvo.dependencies) {
      try {
        dep = require(path.join(dirs.root, 'node_modules', dep));
      } catch (_error) {
        err = _error;
        continue;
      }
      if (dep.polvo && __indexOf.call(mods, dep) < 0) {
        mods.push(dep);
      }
    }
  }

  app_manifest = path.join(dirs.pwd, 'package.json');

  if (fs.existsSync(app_manifest)) {
    app = require(app_manifest);
    for (dep in app.dependencies) {
      try {
        dep = require(path.join(dirs.pwd, 'node_modules', dep));
      } catch (_error) {
        err = _error;
        continue;
      }
      if (dep.polvo && __indexOf.call(mods, dep) < 0) {
        mods.push(dep);
      }
    }
  }

  module.exports = mods;

}).call(this);

/*
//@ sourceMappingURL=plugins.map
*/
