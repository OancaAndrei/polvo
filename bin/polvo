#!/usr/bin/env node

var
  fs = require('fs'),
  path = require('path'),
  exec = require('child_process').exec;

var 
  program = require('commander');

var 
  commands = {
    'new': require('../lib/commands/new'),
    'search': require('../lib/commands/search')
  };


module.exports = program;

program
  .version(require('../package.json').version, '-v, --version')
  .usage('[command] [options]');

program.on('--help', function(){
  console.log('  Examples:');
  console.log('');
  console.log('    $ polvo new app polvo/basic-skel');
  console.log('    $ polvo search jade coffee js');
  console.log('');
  console.log('  Command\'s help:');
  console.log('');
  console.log('    $ polvo <command> --help');
  console.log('    $ polvo new --help');
  console.log('    $ polvo search --help');
  console.log('');
});

program
  .command('search <tag1> [tag..N]')
  .description('search skeletons by tags (and name)')
  .action(function (name) {
    app().search(name);
  }).on('--help', function() {
    console.log('  Examples:');
    console.log();
    console.log('    $ polvo search <tag1> <tag2> <tagN>');
    console.log('    $ polvo search coffee stylus');
    console.log();
  });

program
  .command('new <name> [skel]')
  .description('initializes new app using the given skel')
  .action(function (name, skel) {
    app().new(name, skel);
  }).on('--help', function() {
    console.log('  Examples:');
    console.log();
    console.log('    $ polvo new <name> [<gh-user>/<repo-name>@<version>]');
    console.log('    $ polvo new app polvo/basic-skel');
    console.log('    $ polvo new app polvo/basic-skel@0.1.0');
    console.log();
  });

program
  .command('wiki')
  .description('opens skeletons wiki page')
  .action(function (name, skel) {
    exec('open https://github.com/polvo/polvo/wiki/Skeletons');
  });

program.parse(process.argv);

if(!program.args.length)
  program.help();
